!function(e,t){"object"==typeof module&&module.exports?module.exports=t(e):e.XHR=t(e)}("undefined"!=typeof window?window:this,function(){var e=function(e){var t=function(e){var t=e.responseText,n=e.getAllResponseHeaders();return{text:t,status_code:e.status,status_text:e.statusText,response_type:e.responseType,header_text:n,json:function(){try{return JSON.parse(t)}catch(e){return null}},xml:function(){return e.responseXML},headers:function(){var e={};if(n){var t,r,o=n.split("\n"),u=o.length;for(r=0;r<u;r++)t=o[r].split(": "),t&&2===t.length&&t[0]&&(e[t[0]]=t[1])}return e}}},n=function(){},r=function(){return{ready:n,error:n,success:n,fail:n}},o="",u="",s={},c="",i=e!==!1,a=r(),f=new XMLHttpRequest,l=function(e){return null===e?"null":e!==Object(e)?typeof e:{}.toString.call(e).slice(8,-1).toLowerCase()},d=function(e,t){"ready-error-success-fail".split("-").indexOf(e)>=0&&"function"==l(t)&&(a[e]=t)},p=function(){var e=t(f);4===f.readyState?(a.ready(e,m),200===f.status?a.success(e,m):a.fail(e,m)):a.error(e,m)},y=function(e,t){s[e]=t},x=function(e){i=e},v=function(e){var t,n=encodeURIComponent,r=[];for(t in e)r.push(n(t)+"="+n(e[t]));return r.join("&")},w=function(e,t,n,r,s){return o=e,u=t,c=n,d("success",r),d("fail",s),j()},h=function(e,t,n,r){return t="object"==l(t)?v(t):"",t&&(e=e+"?"+t),w("GET",e,"",n,r)},b=function(e,t,n,r){var o=l(t),u="Content-Type",s="application/";return"object"==o?(t=v(t),y(u,s+"x-www-form-urlencoded")):"formdata"==o||y(u,s+"json"),w("POST",e,t,n,r)},j=function(){f.open(o,u,i);for(var e in s)f.setRequestHeader(e,s[e]);return f.onreadystatechange=p,f.send(c),m},m={url:function(){return u},body:function(){return c},on:d,setRequestHeader:y,setAsync:x,request:w,get:h,post:b,abort:f.abort,reset:function(){i=!0,u=c=o="",s={},a=r()}};return m};return e});